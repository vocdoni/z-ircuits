import { Encrypt } from "./cipher";

// inputs
const msg : bigint = BigInt("3");
const k : bigint = BigInt("650538809577380042220943083323036196153738464670981167525900386056100355632");
const pubKey : [bigint, bigint] = [
    BigInt("14683031697277856265190472023105198820413415816394525437006041413571428119286"), 
    BigInt("8231930431069649913978957226360235712312621187451969137400305691913512440493")
];
// expected outputs
const ec1 : [bigint, bigint] = [
    BigInt("13870605390190200034158220045361352220044134184703469663505826776382964379318"),
    BigInt("19988451487361043386294613979232272400852422814049653297232777755601805547210")
];
const ec2 : [bigint, bigint] = [
    BigInt("17130660075554024492841494240117893165427434053675416454925719559221127183915"),
    BigInt("20889778838156827924544878612357628554369366422015574994293901705391016878937")
];
// compute and compare
const [c1, c2] = Encrypt(msg, pubKey, k);
if (c1[0] === ec1[0] && c1[1] === ec1[1] && c2[0] === ec2[0] && c2[1] === ec2[1]) console.log("Encryption successful!");
else console.log("Encryption failed!");